#!/bin/bash

DIR=$1

HEAD=$(cut -f1 -d' ' /proc/cmdline)
ALT=

if [ $HEAD == "root=UUID=689b853f-3749-4055-8359-054bd6e806b4" ]; then
  ALT="UUID=9bec42be-c362-4de0-9248-b198562ccd40"
elif [ $HEAD == "root=UUID=9bec42be-c362-4de0-9248-b198562ccd40" ]; then
  ALT="UUID=689b853f-3749-4055-8359-054bd6e806b4"
else
  exit
fi	

cat > $DIR/mnt-alt.mount   << EOF
# automatically generated by alt-root-mount-generator

[Unit]
Description=Alternative Root Mount

[Mount]
What=$ALT
Where=/mnt/alt
Type=ext4
EOF

mkdir -p $DIR/local-fs.target.requires
ln -s ../mnt-alt.mount $DIR/local-fs.target.requires/mnt-alt.mount 
